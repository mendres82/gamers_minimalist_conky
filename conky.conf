--[[
# Gamer's Minimalist Conky 1.10
# Author : mendres ; based on the script of archit3x (archit3x@archlinux.us)
# Release date : 08 April 2024
# Tested on : openSUSE Tumbleweed - GNOME Desktop
# Feel free to modity this script ;)
]]

conky.config = {
    alignment = 'top_right',
    background = true,
    border_width = 1,
    cpu_avg_samples = 2,
    default_color = 'gray',
    default_outline_color = 'white',
    default_shade_color = 'white',
    color1 = '#00a489',
    double_buffer = true,
    draw_borders = false,
	default_bar_height=4,
	default_bar_width=100,
    draw_graph_borders = true,
	default_graph_height=35,
	default_graph_width=150,
    draw_outline = false,
    draw_shades = false,
    extra_newline = false,
    font = 'Cantarell:size=7',
    gap_x = 30,
    gap_y = 50,
    minimum_height = 500,
    minimum_width = 350,
    net_avg_samples = 2,
    no_buffers = true,
    out_to_console = false,
    out_to_ncurses = false,
    out_to_stderr = false,
    out_to_x = true,
    own_window = true,
    own_window_class = 'Conky',
    own_window_transparent = true,
    own_window_argb_visual = true,
    own_window_type = 'desktop',
    own_window_hints ='undecorated,sticky,skip_taskbar,skip_pager,below',
    show_graph_range = false,
    show_graph_scale = false,
    stippled_borders = 0,
    update_interval = 1.0,
    uppercase = false,
    use_spacer = 'none',
    use_xft = true,
}

conky.text = [[
${color1}${font ConkySymbols:size=20}p${font} ${voffset -10}GNU/Linux» $hr ${color}
${color1}${goto 35}OS :${goto 80}${color}${execi 86400 cat `ls -atr /etc/*-release | tail -2` | grep "PRETTY_NAME" | cut -d= -f2 |  sed 's/"//g'} (${if_match "${execi 60 cat `ls -atr /etc/*-release | tail -2` | grep 'VERSION_ID' | grep -Poh '\d+'}">="${execi 60 zypper info openSUSE-release | grep 'Version' | grep -v 'Status' | awk -F': ' '{print $2}' | cut -d- -f1}"}${else}${color red}${endif}${execi 60 cat `ls -atr /etc/*-release | tail -2` | grep 'VERSION_ID' | grep -Poh '\d+'}${color})
${color1}${goto 35}Kernel :${goto 80}${color}$kernel ($machine)

${color1}${goto 35}Mesa :${goto 80}${color}${execi 60 zypper se -is --match-exact Mesa | grep 'Paket' | awk -F'|' 'NR==2{print $4}' | cut -f1 -d-}
${color1}${goto 35}Vulkan :${goto 80}${color}${execi 60 zypper se -is --match-exact libvulkan1 | grep 'Paket' | awk -F'|' 'NR==2{print $4}' | awk -F. '{print $1"."$2"."$3}' | cut -f1 -d-} (${execi 60 vulkaninfo | grep 'driverName' | tail -n1 | awk -F'= ' '{print $2}'})
${color1}${goto 35}Wayland :${goto 80}${color}${execi 60 zypper se -is --match-exact libwayland-client0 | grep 'Paket' | awk -F'|' 'NR==2{print $4}' | cut -f1 -d-}
${color1}${goto 35}GNOME :${goto 80}${color}${execi 86400 zypper se -is --match-exact gnome-shell | grep 'Paket' | awk -F'|' 'NR==2{print $4}' | cut -f1 -d-}

${color1}${font ConkySymbols:size=16}f${font} ${voffset -10} System» $hr${color}
${color1}${goto 35}Uptime :${goto 80}${color}$uptime_short ${alignr}${color1}Load : ${color}${loadavg}

${color1}${goto 35}CPU :${goto 80}${color}${execi 86400 lscpu | grep 'Modellname' | cut -f2 -d: | awk '{$1=$1}1'}
${color1}${goto 35}${stippled_hr}${color}
${color1}${goto 35}Thread 1 :${goto 100}${color}${freq_g 1}GHz ${alignr}${cpu cpu1}% ${cpubar cpu1}
${color1}${goto 35}Thread 2 :${goto 100}${color}${freq_g 2}GHz ${alignr}${cpu cpu2}% ${cpubar cpu2}
${color1}${goto 35}Thread 3 :${goto 100}${color}${freq_g 3}GHz ${alignr}${cpu cpu3}% ${cpubar cpu3}
${color1}${goto 35}Thread 4 :${goto 100}${color}${freq_g 4}GHz ${alignr}${cpu cpu4}% ${cpubar cpu4}
${color1}${goto 35}Thread 5 :${goto 100}${color}${freq_g 5}GHz ${alignr}${cpu cpu5}% ${cpubar cpu5}
${color1}${goto 35}Thread 6 :${goto 100}${color}${freq_g 6}GHz ${alignr}${cpu cpu6}% ${cpubar cpu6}
${color1}${goto 35}Thread 7 :${goto 100}${color}${freq_g 7}GHz ${alignr}${cpu cpu7}% ${cpubar cpu7}
${color1}${goto 35}Thread 8 :${goto 100}${color}${freq_g 8}GHz ${alignr}${cpu cpu8}% ${cpubar cpu8}
${color1}${goto 35}Thread 9 :${goto 100}${color}${freq_g 9}GHz ${alignr}${cpu cpu9}% ${cpubar cpu9}
${color1}${goto 35}Thread 10 :${goto 100}${color}${freq_g 10}GHz ${alignr}${cpu cpu10}% ${cpubar cpu10}
${color1}${goto 35}Thread 11 :${goto 100}${color}${freq_g 11}GHz ${alignr}${cpu cpu11}% ${cpubar cpu11}
${color1}${goto 35}Thread 12 :${goto 100}${color}${freq_g 12}GHz ${alignr}${cpu cpu12}% ${cpubar cpu12}

${color1}${goto 35}GPU :${goto 80}${color}${execi 86400 /usr/sbin/lshw -C display 2> /dev/null | grep 'vendor' | cut -d[ -f2 | cut -d/ -f1 | cut -d] -f1} ${execi 86400 /usr/sbin/lshw -C display 2> /dev/null | grep 'product' | cut -d[ -f2 | cut -d] -f1}
${color1}${goto 35}${stippled_hr}${color}
${color1}${goto 35}Core :${goto 100}${color}${texeci 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f16 | awk '{print $3}' | rev | cut -c 5- | rev | sed 's/\./,/g'}GHz ${alignr}${texeci 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f2 | awk '{print $2}' | cut -d. -f1}% ${execibar 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f2 | awk '{print $2}' | cut -d. -f1}
${color1}${goto 35}VRAM :${goto 100}${color}${texeci 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f15 | awk '{print $3}' | rev | cut -c 5- | rev | sed 's/\./,/g'}GHz

${color1}${goto 35}Gamemode :${goto 100}${if_match "${exec gamemoded -s | awk '{print $3}'}"=="active"}${color green}${else}${color red}${endif}${exec gamemoded -s | awk '{print $3}'}


${color1}${font ConkySymbols:size=16}h${font} ${voffset -10} Temperature» $hr${color}
${color1}${goto 35}CPU :${goto 100}${color}${exec sensors nct6797-isa-0a20 | grep 'TSI0_TEMP' | awk '{print $2}'}${goto 260}${color1}GPU : ${alignr}${color}${exec sensors amdgpu-pci-2d00 | grep 'junction' | awk '{print $2}'}
${offset 30}${execgraph "sensors nct6797-isa-0a20 | grep 'TSI0_TEMP' | awk '{print $2}' | cut -c 2- | rev | cut -c 3- | rev" 00ff00 ffc000 -t} ${alignr}${execgraph "sensors amdgpu-pci-2d00 | grep 'junction' | awk '{print $2}' | cut -c 2- | rev | cut -c 3- | rev" 00ff00 ffc000 -t}
${color1}${goto 35}Fan :${goto 100}${color}${exec sensors nct6797-isa-0a20 | grep 'fan2' | awk '{print $2 " " $3}'}${goto 260}${color1}Fan : ${alignr}${color}${exec sensors amdgpu-pci-2d00 | grep 'fan1' | awk '{print $2 " " $3}'}
${color1}${goto 35}Power :${goto 100}${color}${exec tail -1 /tmp/turbostat.tmp} W${goto 260}${color1}Power : ${alignr}${color}${exec sensors | grep 'PPT' | awk '{print $2 " " $3}'}

${color1}${goto 35}SSD :${goto 100}${color}${exec sensors nvme-pci-0100 | grep 'Composite' | awk '{print $2}'}


${color1}${font ConkySymbols:size=16}J${font} ${voffset -10}Memory» $hr${color}
${color1}${goto 35}RAM :${goto 80}${color}$mem / $memmax ${alignr}$memperc% ${membar}
${color1}${goto 35}ZRAM :${goto 80}${color}$swap / $swapmax $alignr}$swapperc% ${swapbar}

${color1}${goto 35}VRAM :${goto 80}${color}${texeci 5 vram=$(radeontop -d- -l1 | grep 'gpu' | cut -d, -f13 | awk '{print $3}' | rev | cut -c 6- | rev); printf %.2f "$((10**3 * $vram/1000))e-3"}GiB / ${execi 86400 maxvram=$(glxinfo | grep 'Video memory' | awk -F': ' '{print $2}' | rev | cut -c 3- | rev); printf %.2f "$((10**3 * $maxvram/1024))e-3"}GiB ${alignr}${texeci 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f13 | awk '{print $2}' | cut -d. -f1}% ${execibar 5 radeontop -d- -l1 | grep 'gpu' | cut -d, -f13 | awk '{print $2}' | cut -d. -f1}


${color1}${font ConkySymbols:size=16}n${font} ${voffset -10} Processes» $hr${color}

${color1}${goto 35}CPU usage ${alignr}Memory usage${color}
${color1}${goto 35}${stippled_hr}${color}
${goto 35}${top name 1}${goto 155}${color}${top cpu 1}% ${goto 200}${top_mem name 1}${alignr}${top_mem mem_res 1}
${goto 35}${top name 2}${goto 155}${color}${top cpu 2}% ${goto 200}${top_mem name 2}${alignr}${top_mem mem_res 2}
${goto 35}${top name 3}${goto 155}${color}${top cpu 3}% ${goto 200}${top_mem name 3}${alignr}${top_mem mem_res 3}
${goto 35}${top name 4}${goto 155}${color}${top cpu 4}% ${goto 200}${top_mem name 4}${alignr}${top_mem mem_res 4}
${goto 35}${top name 5}${goto 155}${color}${top cpu 5}% ${goto 200}${top_mem name 5}${alignr}${top_mem mem_res 5}

${color1}${goto 35}Processes: ${color}$processes ${alignr}${color1}Running: ${color}$running_processes


${color1}${font ConkySymbols:size=16}k${font} ${voffset -10} Storage» $hr${color}
${color1}${goto 35}ROOT :${goto 80}${color}${fs_used /} / ${fs_size /} ${alignr}${fs_used_perc /}% ${fs_bar /}
${color1}${goto 35}HOME :${goto 80}${color}${fs_used /home} / ${fs_size /home} ${alignr}${fs_used_perc /home}% ${fs_bar /home}

${color1}${font ConkySymbols:size=16}i${font} ${voffset -10} Network» $hr${color}
${color1}${goto 35}Hostname :${goto 125}${color}${nodename br0}
${color1}${goto 35}IP Address :${goto 125}${color}${addrs br0}
${goto 125}${color}${execi 60 ip -6 addr | ip -6 addr | grep -E 'fd00.*mngtmpaddr' | cut -d' ' -f6 | cut -d/ -f1}
${color1}${goto 35}Gateway :${goto 125}${color}${execi 60 ip route show 0.0.0.0/0 | awk '{print $3}' | head -n 1}\
${if_match "${execi 60 ip route show 0.0.0.0/0 | awk '{print $3}' | wc -l}"=="2"}${goto 125}${voffset 13}${execi 60 ip route show 0.0.0.0/0 | awk 'NR==2{print $3}'}${else}${endif}
${color1}${goto 35}DNS Server :${goto 125}${color}${execi 60 cat /etc/resolv.conf | grep 'nameserver' | awk 'NR==1{print $2}'}
${goto 125}${color}${execi 60 cat /etc/resolv.conf | grep 'nameserver' | awk 'NR==2{print $2}'}
${color1}${goto 35}DNS Domain :${goto 125}${color}${execi 60 cat /etc/resolv.conf | grep 'search' | awk 'NR==1{print $2}'}

${color1}${goto 35}Ext. IP Address :${goto 125}${color}${execi 60 wget http://v4.ipv6-test.com/api/myip.php -q -O -}
${goto 125}${color}${execi 60 wget http://v6.ipv6-test.com/api/myip.php -q -O -}

${color1}${goto 35}Total Down/Up :${goto 125}${color}${totaldown br0} / ${totalup br0} 
${color1}${goto 35}Speed Down/Up :${goto 125}${color}${downspeed br0} / ${upspeed br0}
${offset 30}${downspeedgraph br0 00a489 00a489 6250000} ${alignr}${upspeedgraph br0 00a489 00a489 250000}


]]
